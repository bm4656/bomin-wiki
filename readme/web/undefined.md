# 브라우저 동작 원리

### 요약

1. DOM 트리 구축
2. CSSOM 트리 구축&#x20;
3. 렌더 트리 구축&#x20;
4. 렌더 트리 배치&#x20;
5. 렌더 트리 그리기

### 브라우저 동작 원리

1. 사용자가 주소창을 통해 브라우저에 접속하면 → 브라우저는 서버로부터 HTML, CSS, JavaScript와 같은 웹사이트에 필요한 `리소스를 다운`
2. 브라우저 렌더링 엔진은 먼저 웹 페이지의 HTML 문서를 파싱, DOM트리 구축
3. CSS 스타일 시트 또한 파싱 후 CSSOM 트리 구축
4. 브라우저는 이 두 트리를 결합하여 렌더 트리를 생성
5. &#x20;이 렌더 트리는 실제 화면에 표시되는 모든 요소를 포함하는 구조이지만 시각적으로 숨겨진 요소(display: none) 등은 포함되지 않음
6. 이제 브라우저는 각 요소의 위치와 크기를 계산하여 렌더 트리를 배치 (배치말고 레이아웃 또는 리플로라고도 함)
7. 그 후 실제 화면에 이 렌더 트리들을 그림(Painting)

### 자바스크립트 코드는?

* 브라우저는 **HTML 파싱 도중** `<script>` 태그를 만나면 해당 스크립트 코드를 다운로드하고 파싱합니다. 이 시점에서 파싱된 자바스크립트 코드는 실행을 위해 메모리에 로드됩니다. 이때 자바스크립트 코드 내에서 만나는 함수나 변수 선언 등의 작업은 실행되지 않고, 파싱만 이루어집니다.
* 일반적으로 브라우저는 HTML 파싱 중에 자바스크립트 코드를 만나면 해당 코드를 파싱하고 실행 대기 상태에 두지만, `defer` 속성이 있는 `<script>` 태그를 만나면 페이지 로딩이 완료되기 전까지 실행을 지연시킵니다. 따라서 `defer` 속성이 있는 스크립트는 페이지의 DOM이 완전히 로드되기 전까지 실행되지 않습니다.

#### HTML CSS를 파싱해서 읽다가 \<script> Tag가 실행될때, 브라우저가 DOM 생성을 멈추는 이유는?

* 자바스크립트로 DOM을 변형 할 수 있기 때문에 우선 자바스크립트를 파싱해서 실행 완료 후 DOM 생성을 이어나가는 것입니다.

#### script Tag를 body 아래에 위치 하거나 DOM 생성이 완료된 시점에 위치하는 이유는? 그리고 css-in-js는 언제 실행 될까요?

* 생성되지 않은 DOM을 조작하거나 실행한다면 에러가 날 수 있습니다. 따라서 body 생성 이후나 DOM 생성이 완료된 시점에서 JavaScript가 실행될 수 있게 위치를 선정하는 것이 좋습니다.
* css-in-js는 자바스크립트로 동작합니다. 따라서 DOM 생성이 완료 된 시점에 자바스크립트가 실행될 때 같이 실행됩니다.



[https://d2.naver.com/helloworld/59361](https://d2.naver.com/helloworld/59361)
